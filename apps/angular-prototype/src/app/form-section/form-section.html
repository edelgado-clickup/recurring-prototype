<section class="calendar-section">
  <div class="calendar-picker">
    
    <!-- Date Input Fields Header - 48px height -->
    <div class="date-fields-header">
      <div class="date-field">
        <img [src]="SupernovaAssets['calendar']" alt="" class="field-icon-img" />
        <span class="field-placeholder">Start date</span>
      </div>
      <div class="date-field">
        <img [src]="SupernovaAssets['calendar']" alt="" class="field-icon-img" />
        <span class="field-placeholder">Due date</span>
      </div>
    </div>

    <!-- Divider -->
    <div class="divider"></div>

    <!-- Main Calendar Container - 264px height -->
    <div class="calendar-container">
      
      <!-- Quick Select Sidebar (Left) - Show when NOT in recurring mode -->
      <div class="quick-select" *ngIf="!isRecurringMode">
        <button class="quick-option">
          <span class="option-label">Today</span>
          <span class="option-value">Mon</span>
        </button>
        <button class="quick-option">
          <span class="option-label">Later</span>
          <span class="option-value">5:44 pm</span>
        </button>
        <button class="quick-option">
          <span class="option-label">Tomorrow</span>
          <span class="option-value">Tue</span>
        </button>
        <button class="quick-option">
          <span class="option-label">This weekend</span>
          <span class="option-value">Sat</span>
        </button>
        <button class="quick-option">
          <span class="option-label">Next week</span>
          <span class="option-value">Mon</span>
        </button>
        <button class="quick-option">
          <span class="option-label">Next weekend</span>
          <span class="option-value">25 Jun</span>
        </button>
        <button class="quick-option">
          <span class="option-label">2 weeks</span>
          <span class="option-value">27 Jun</span>
        </button>
        <button class="quick-option">
          <span class="option-label">4 weeks</span>
          <span class="option-value">11 Jul</span>
        </button>
      </div>

      <!-- Recurring Form (Left) - Show when IN recurring mode -->
      <div class="recurring-form" *ngIf="isRecurringMode">
        
        <!-- Trigger -->
        <div class="form-row">
          <label class="row-label">Trigger</label>
          <select [(ngModel)]="recurringData.trigger" class="dropdown-field">
            <option value="complete">Task is Complete</option>
            <option value="created">Task is Created</option>
            <option value="updated">Task is Updated</option>
          </select>
        </div>

        <!-- Every -->
        <div class="form-row">
          <label class="row-label">every</label>
          <div class="inline-controls">
            <input type="number" [(ngModel)]="recurringData.repeatEvery" min="1" class="number-field" />
            <select [(ngModel)]="recurringData.repeatUnit" class="dropdown-field">
              <option value="day">day</option>
              <option value="week">week</option>
              <option value="month">month</option>
              <option value="year">year</option>
            </select>
          </div>
        </div>

        <!-- On (weekday selector) -->
        <div class="form-row" *ngIf="recurringData.repeatUnit === 'week'">
          <label class="row-label">on</label>
          <div class="weekday-selector">
            <button type="button" class="weekday-btn" [class.active]="recurringData.repeatOn.includes('S')" (click)="toggleWeekday('S')">S</button>
            <button type="button" class="weekday-btn" [class.active]="recurringData.repeatOn.includes('M')" (click)="toggleWeekday('M')">M</button>
            <button type="button" class="weekday-btn" [class.active]="recurringData.repeatOn.includes('T')" (click)="toggleWeekday('T')">T</button>
            <button type="button" class="weekday-btn" [class.active]="recurringData.repeatOn.includes('W')" (click)="toggleWeekday('W')">W</button>
            <button type="button" class="weekday-btn" [class.active]="recurringData.repeatOn.includes('Th')" (click)="toggleWeekday('Th')">T</button>
            <button type="button" class="weekday-btn" [class.active]="recurringData.repeatOn.includes('F')" (click)="toggleWeekday('F')">F</button>
            <button type="button" class="weekday-btn" [class.active]="recurringData.repeatOn.includes('Sa')" (click)="toggleWeekday('Sa')">S</button>
          </div>
        </div>

        <!-- At (time picker) - Only show when time field is enabled -->
        <div class="form-row" *ngIf="showTimeField">
          <label class="row-label">at</label>
          <div class="time-picker-wrapper">
            <input type="time" [(ngModel)]="recurringData.time" class="time-field" />
            <button type="button" class="clear-btn" (click)="removeTimeField()">
              <img [src]="SupernovaAssets['close-small']" alt="Remove" class="clear-icon" />
            </button>
          </div>
        </div>

        <!-- Ends -->
        <div class="form-row">
          <label class="row-label">ends</label>
          <select [(ngModel)]="recurringData.endsOn" class="dropdown-field">
            <option value="never">Never</option>
            <option value="after">After 10 occurrences</option>
            <option value="date">On date</option>
          </select>
        </div>

      </div>

      <!-- Calendar Grid (Right) -->
      <div class="calendar-grid">
        
        <!-- Calendar Header -->
        <div class="calendar-header">
          <div class="month-year">
            <span class="month">June</span>
            <span class="year">2022</span>
          </div>
          <div class="header-actions">
            <button class="today-btn">Today</button>
            <button class="nav-btn">
              <img [src]="SupernovaAssets['chevron-up']" alt="" class="nav-icon" />
            </button>
            <button class="nav-btn">
              <img [src]="SupernovaAssets['chevron-down']" alt="" class="nav-icon" />
            </button>
          </div>
        </div>

        <!-- Days of Week -->
        <div class="weekdays">
          <div class="weekday">Su</div>
          <div class="weekday">Mo</div>
          <div class="weekday">Tu</div>
          <div class="weekday">We</div>
          <div class="weekday">Th</div>
          <div class="weekday">Fr</div>
          <div class="weekday">Sa</div>
        </div>

        <!-- Calendar Weeks -->
        <div class="calendar-weeks">
          <!-- Week 1 -->
          <div class="week-row">
            <div class="day prev-month">29</div>
            <div class="day prev-month">30</div>
            <div class="day prev-month">31</div>
            <div class="day">1</div>
            <div class="day selected">2</div>
            <div class="day">3</div>
            <div class="day">4</div>
          </div>

          <!-- Week 2 -->
          <div class="week-row">
            <div class="day">5</div>
            <div class="day">6</div>
            <div class="day">7</div>
            <div class="day">8</div>
            <div class="day">9</div>
            <div class="day">10</div>
            <div class="day">11</div>
          </div>

          <!-- Week 3 -->
          <div class="week-row">
            <div class="day">12</div>
            <div class="day">13</div>
            <div class="day">14</div>
            <div class="day">15</div>
            <div class="day">16</div>
            <div class="day">17</div>
            <div class="day">18</div>
          </div>

          <!-- Week 4 -->
          <div class="week-row">
            <div class="day">19</div>
            <div class="day">20</div>
            <div class="day">21</div>
            <div class="day">22</div>
            <div class="day">23</div>
            <div class="day">24</div>
            <div class="day">25</div>
          </div>

          <!-- Week 5 -->
          <div class="week-row">
            <div class="day">26</div>
            <div class="day">27</div>
            <div class="day">28</div>
            <div class="day">29</div>
            <div class="day">30</div>
            <div class="day next-month">1</div>
            <div class="day next-month">2</div>
          </div>

          <!-- Week 6 -->
          <div class="week-row">
            <div class="day next-month">3</div>
            <div class="day next-month">4</div>
            <div class="day next-month">5</div>
            <div class="day next-month">6</div>
            <div class="day next-month">7</div>
            <div class="day next-month">8</div>
            <div class="day next-month">9</div>
          </div>
        </div>

      </div>
    </div>

    <!-- Divider -->
    <div class="divider"></div>

    <!-- Bottom Button Bar -->
    <div class="button-bar">
      <!-- Show "Set recurring" button when NOT in recurring mode -->
      <button class="recurring-btn" *ngIf="!isRecurringMode" (click)="showRecurringForm()">
        <img [src]="SupernovaAssets['recurring']" alt="" class="recurring-icon-img" />
        <span>Set recurring</span>
      </button>

      <!-- Show Action + Time + Cancel/Save buttons when IN recurring mode -->
      <div class="recurring-action-bar" *ngIf="isRecurringMode">
        <div class="left-buttons">
          <button class="action-btn">
            <img [src]="SupernovaAssets['add']" alt="" class="action-icon" />
            <span>Action</span>
          </button>
          <button class="time-btn" (click)="addTimeField()" [disabled]="showTimeField">
            <img [src]="SupernovaAssets['add']" alt="" class="time-icon" />
            <span>Time</span>
          </button>
        </div>
        <div class="right-buttons">
          <button class="cancel-btn" (click)="cancelRecurring()">
            Cancel
          </button>
          <button class="save-btn" (click)="saveRecurring()">
            Save
          </button>
        </div>
      </div>
    </div>

  </div>
</section>
